package com.project2.controllers;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;

import com.project2.models.Car;
import com.project2.repository.ICarDao;

@Controller
public class ViewCarsController {
   @Autowired
   ICarDao cardao;
	
	//view all cars
   @RequestMapping(value="/viewcars" )
	public ModelAndView viewcars(){  
        List<Car> carslist=cardao.getAllCarsRowMapper();  
        return new ModelAndView("viewcars","carslist",carslist); 
    }
	
	//add a new car page
	@RequestMapping(value="/addcar")
	public ModelAndView addcar(@ModelAttribute("savecarform") Car car) {
		
		return new ModelAndView("addcar", "savecarform", car);
	}
	//save new car form	
	
	@RequestMapping(value="/savecar", method = RequestMethod.POST)
	public ModelAndView saveCars(@ModelAttribute("savecarform") Car car) {
		cardao.saveCar(car);
		return new ModelAndView("redirect:/viewcars.html"); 
	}
	
	//delete a car after id
	@RequestMapping(value="delete{id}", method = RequestMethod.GET) 
    public ModelAndView deletecar(@PathVariable int id){
	    	cardao.deletecar(id);
	    	return new ModelAndView("redirect:/viewcars.html"); 
	    }
	
	//edit existing car after id
	@RequestMapping(value= "/edit{id}", method = RequestMethod.GET)
	public ModelAndView editcar(@PathVariable int id) {
		Car aCar = cardao.getCarById(id);
		ModelAndView mv = new ModelAndView();
		mv.setViewName("editcar");
		mv.addObject("editcarform", aCar);
		return mv;
	}
	
	//save changes made on existing car
	@RequestMapping(value= "/savechange", method = RequestMethod.POST)
	  public ModelAndView editsave(@ModelAttribute("editcarform") Car car){  
        cardao.updateCar(car);  
        return new ModelAndView("redirect:/viewcars");  
    }  
	
	//search car after make
	//view all cars
	   @RequestMapping(value="/searchmake" )
		public ModelAndView searchcar(){  
	        List<Car> carslist=cardao;  
	        return new ModelAndView("viewcars","carslist",carslist); 
	    }
	    
}
